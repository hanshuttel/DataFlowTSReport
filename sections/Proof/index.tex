\documentclass[../../master.tex]{subfiles}
\begin{document}
\section{Soundness}
We will now show the soundness of the type system, i.e., the type of an occurrence correspond to the dependencies and the alias information from the semantics.
To show that the type system is sound, we will first introduce the type rules for values and the relation between between the collection semantics and the type system, i.e, how the relation between binding models and the relation between the semantics and the type of occurrences.
After that, we will present some properties in the semantics and type system that are used in the soundness proof.
And lastly, we will show the soundness of the type system.

\subfile{valueTRules.tex}
\subfile{agreement.tex}

\subsection{Properties}
Before we show the soundness proof, we will first present some properties about the semantics and type system.
These properties presents some areas about local information, and as such uses \cref{def:fv}.

The first property we present is a property of the dependency function.
Since the dependency function is global, and as such they can contain side effects after evaluation, 
any new variable bindings introduced to the dependency function by evaluating an occurrence $e^p$, those variables are then not free in $e^p$.

\begin{lemma}[History]\label{lemma:His}
	Suppose $e^p$ is an occurrence, that
	$$env\vdash\left\langle e^{p},sto,(w,\sqsubseteq_w),p'\right\rangle\rightarrow\left\langle v,sto',(w',\sqsubseteq_w'),(L,V),p''\right\rangle$$
		and $x^{p_1}\in dom(w')\backslash dom(w)$.
		Then $x\notin fv(e^{p})$
\end{lemma}
\subfile{HisProof/index.tex}

The second property is the strengthening of the type environment.
This strengthening lemma states that if there is a binding the type environment, used to type an occurrence $e^p$, and the variables is not free in $e^p$ then the binding can be removed.

\begin{lemma}[Strengthening]\label{lemma:Strength}
	If $\Gamma[x^{p'}:T'],\Pi\vdash e^{p}:T$ and $x\notin fv(e^p)$, then $\Gamma,\Pi\vdash e^{p}:T$
\end{lemma}
\subfile{StrProof/index.tex}

We will now present the soundness of the type system.

\begin{theorem}[Soundness of type system]
	Suppose $e^{p'}$ is an occurrence where
	\begin{itemize}
		\item $env\vdash\left\langle e^{p'},sto,(w,\sqsubseteq_w),p\right\rangle\rightarrow\left\langle v,sto',(w',\sqsubseteq_w'),(L,V),p''\right\rangle$,
		\item $\Gamma,\Pi\vdash e^{p'} : T$
		\item $\Gamma,\Pi\vdash env$
		\item $(env,sto,(w,\sqsubseteq_w))\models(\Gamma,\Pi)$
	\end{itemize}
	Then we have that:
	\begin{itemize}
		\item $\Gamma,\Pi\vdash v:T$
		\item $(env,sto',(w',\sqsubseteq_w'))\models(\Gamma,\Pi)$
		\item $(env,(w',\sqsubseteq_w'),v,(L,V))\models(\Gamma,T)$
	\end{itemize}
\end{theorem}
\subfile{SoundProof/index.tex}
\end{document}
